{"root":{"data":{"id":"d889mouq7400","created":1741171065224,"text":"Snack组件库"},"children":[{"data":{"id":"d88teiei7880","created":1741226846468,"text":"sie-form","layout":null},"children":[]},{"data":{"id":"d88teoiucog0","created":1741226859791,"text":"sie-table","layout":null},"children":[]},{"data":{"id":"d88tetno2480","created":1741226870966,"text":"简化模板","expandState":"expand","layout":null},"children":[{"data":{"id":"d88tf7cxld40","created":1741226900792,"text":"主表+搜索","layout":null},"children":[{"data":{"id":"d88tfhsfsf40","created":1741226923497,"text":"带搜索","layout":null},"children":[]}]},{"data":{"id":"d88tf3g0spc0","created":1741226892272,"text":"弹窗表单","layout":null,"expandState":"expand"},"children":[{"data":{"id":"d88ycz11ayw0","created":1741240831480,"text":"示例代码","expandState":"collapse","layout":null},"children":[{"data":{"id":"d88tft92kyo0","created":1741226948448,"text":"<template>\n  <tiny-dialog-box v-model:visible=\"visible\" :title=\"dialogTitle\" width=\"55%\" right-slide :close-on-click-modal=\"false\">\n\t<sie-form ref=\"formRef\" v-model=\"formData\" v-bind=\"formOptions\" style=\"padding-top: 20px\"></sie-form>\n\n\t<template #footer>\n\t  <tiny-button type=\"primary\" :loading=\"loading\" @click=\"handleConfirm\">保 存</tiny-button>\n\t  <tiny-button :loading=\"loading\" @click=\"hideDialog\">取 消</tiny-button>\n\t</template>\n  </tiny-dialog-box>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  name: \"DetailDialog\"\n};\n</script>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from \"vue\";\nimport { SieForm, SitePopeditor, WorkshopPopeditor, CustomerPopeditor } from \"@dme/snack-ui\";\n\nimport api from \"../api/index.js\";\n\nimport { catchErr } from \"@/utils/index.js\";\nimport { $notify } from \"@/utils/tiny-vue.js\";\n\nconst emits = defineEmits([\"save\"]);\n\n// 加载状态\nconst loading = ref(false);\n// 弹窗，显示隐藏\nconst visible = ref(false);\n// 操作类型\nconst operateType = ref(\"add\");\n// 弹窗标题\nconst dialogTitle = computed(() => `${operateType.value == \"edit\" ? \"编辑\" : \"新增\"}xxx`);\n/**\n * 显示弹窗\n * @param operateType 操作类型\n * @param data 传入数据\n */\nconst showDialog = (type = \"add\", data = null) => {\n  visible.value = true;\n  operateType.value = type;\n\n  // 编辑、复制新增时，回显数据\n  if (operateType.value === \"edit\" || operateType.value === \"copyAdd\") {\n\tformData.value = { ...data };\n  }\n};\n\n/**\n * 隐藏弹窗\n */\nconst hideDialog = () => {\n  formRef.value.resetFields();\n\n  visible.value = false;\n};\n\n// 表单实例\nconst formRef = ref();\n// 表单数据\nconst formData = ref({});\n// 表单配置\nconst formOptions = computed(() => ({\n  labelWidth: \"120px\",\n  validateType: \"text\",\n  formItemList: []\n}));\n\nconst handleConfirm = () => {\n  if (loading.value) {\n\treturn;\n  }\n\n  // 表单校验\n  formRef.value.validate(async isValidate => {\n\tif (!isValidate) {\n\t  return;\n\t}\n\n\tloading.value = true;\n\ttry {\n\t  // 带有id，调用更新接口，否则调用新增接口\n\t  const _api = formData.value?.id ? api.xxx.update : api.xxx.create;\n\n\t  const res = await _api(formData.value);\n\t  if (res.code === 0) {\n\t    $notify(\"保存成功\");\n\n\t    emits(\"save\");\n\n\t    hideDialog();\n\t  }\n\t} catch (err) {\n\t  catchErr(err);\n\t}\n\tloading.value = false;\n  });\n};\n\ndefineExpose({ showDialog, hideDialog });\n</script>\n\n<style lang=\"less\"></style>","layout":null},"children":[]}]},{"data":{"id":"d88yclq3tdk0","created":1741240802521,"text":"需要配置的点：\n1. dialogTitle 弹窗标题；\n2. SieForm 的formOptions，配置表单内容；\n3. handleConfirm 事件里的api 。","expandState":"expand","layout":null},"children":[]}]}]}]},"template":"right","theme":"fresh-blue","version":"1.4.43"}